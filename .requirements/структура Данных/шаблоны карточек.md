# Шаблоны карточек объектов данных

> **Важно:** этот файл в `.requirements/**` — **шаблон** (read-only).
> Карточки создаются в `docs/requirements/структура Данных/<type-dir>/<object>.md`.

---

## 1. Общая карточка (обязательна для всех типов)

```markdown
# `<object_name>`

* тип: `<table|collection|series|kv-namespace|node/edge|bucket|topic|view>`
* назначение: `<1-2 строки>`
* владелец: `<сервис/модуль>`
* источники `docs/**`: `<docs/...#...>`
* источники проверки: `<path|command>`
* статус: `<draft|verified>`, ревью: `<кто/когда/PR>`
```

---

## 2. Структура по типу хранилища

### 2.1 relational (таблица/представление)

```markdown
## Структура

| Поле | Тип | PK | FK | Null | Default | Ограничения | Примечание |
|---|---|---:|---|---:|---|---|---|

## Ключи и связи

* PK: `<...>`
* FK: `<from>.<field> -> <to>.<field>` (policy `ON UPDATE/DELETE`: `<...>` с ссылкой на `docs/**/обоснование выбора.md`)

## Индексы и ограничения

* индексы: `<...>`
* unique/check: `<...>`
```

### 2.2 document (коллекция)

```markdown
## Структура

| Поле | Тип | Обяз. | Индекс | Валидация | Примечание |
|---|---|---:|---:|---|---|

## Правила

* validation/JSON Schema: `<...>`
* индексы: `<...>`
* примеры документов: `<1-3 примера (кратко)>`
```

### 2.3 time-series

```markdown
## Структура

| Поле | Тип | Обяз. | Индекс | Примечание |
|---|---|---:|---:|---|

## Политики

* партиционирование/шардирование: `<...>`
* retention: `<...>` (основание: `docs/**`)
* downsampling/агрегаты: `<...>`
```

### 2.4 kv

```markdown
## Схема

* namespace: `<...>`
* формат ключа: `<...>`
* значения: `<формат/сериализация>`
* TTL/retention: `<...>`
* атомарные операции/консистентность: `<...>`
```

### 2.5 graph

```markdown
## Модель

* node types: `<...>`
* edge types: `<...>`
* свойства: `<...>`
* индексы/constraints: `<...>`
* паттерны запросов: `<...>`
```

### 2.6 object-storage

```markdown
## Схема

* bucket: `<...>`
* объект/ключ: `<формат>`
* метаданные: `<набор полей>`
* lifecycle/retention: `<...>`
* доступ: `<ACL/политики>`
```

### 2.7 event-log/stream

```markdown
## Схема

* topic: `<...>`
* схема сообщения: `<поля/типы/версия>`
* совместимость: `<backward/forward/full>`
* партиции/ключ: `<...>`
* retention: `<...>`
```

---

## 3. Использование (обязательно для всех типов)

```markdown
## Использование

* сценарии/операции: `<пункты + ссылки на docs/**>`
* критичные запросы/агрегации/чтения: `<минимум 1-3>`
* требования по SLA/целостности/безопасности: `<ссылки на docs/**>`
```

---

## 4. Примечания (обязательно для всех типов)

```markdown
## Примечания

* денормализация/дублирование: `<если есть — почему + ссылка>`
* риски роста/блокировок/ретенции: `<кратко>`
* совместимость изменений (если важно): `<кратко>`
```

---

## 5. Процедуры заполнения карточки (H6)

### 5.1 Собери источники и контекст (H7)
**Что делать:**
- Укажи источники `docs/**` (требования/сценарии).
- Укажи источники проверки (код/DDL/миграции).

**Считать верным:**
- В карточке есть ссылки на `docs/**` и пути к реализации.

**Считать неверным:**
- Карточка без источников или с относительными ссылками вне `docs/**`.

### 5.2 Заполни структуру по типу (H7)
**Что делать:**
- Используй раздел 2 в зависимости от типа хранилища.
- Заполни обязательные поля и ограничения.

**Считать верным:**
- Поля/типы/ограничения описаны и соответствуют модели.

**Считать неверным:**
- Пропущены обязательные поля или смешаны модели.

### 5.3 Опиши использование и риски (H7)
**Что делать:**
- Укажи сценарии использования и критичные запросы.
- Зафиксируй риски и совместимость изменений.

**Считать верным:**
- Есть хотя бы 1–3 критичных сценария и риск/ограничение.

**Считать неверным:**
- Разделы “Использование/Примечания” пустые.

---

## 6. Критерии готовности карточки

### Минимальные
- [ ] Заполнены источники `docs/**` и источники проверки.
- [ ] Заполнена структура по типу хранилища.
- [ ] Заполнены разделы “Использование” и “Примечания”.
