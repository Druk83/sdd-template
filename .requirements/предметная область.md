# Предметная область (H6)

Процедура этапа **[1]** трека разработки: создание базового описания домена системы.

**Цель этапа:** понять *что строим и зачем*, зафиксировать *термины* и *границы*.

## Входные данные

- Файлы в `.source/` (идеи, концепции, требования заказчика, интервью, регламенты)
- Результаты анализа базового контекста (если был этап подтверждения)

## Выходные данные

- `docs/requirements/предметная область.md` (H8)

> **Важно:** После принятия этапа [1] следует обязательный этап **[1] завершение: README L0**.
> Процедура: `.manifest/readmemanifest.md`. Даже если README будет неполным на этом этапе, его создание обязательно.

## Что НЕ входит в этап [1]

| Информация | Куда относится |
|------------|----------------|
| NFR/метрики/ограничения | [2] Обоснование выбора, [3] Требования |
| Детальные события/команды/агрегаты | [5] Сценарии |
| Bounded Contexts | [4] Домены |
| Детальные state machine/инварианты/связи | [4] Домены, [6] Структура данных |
| Интерфейсы/каналы/экранные формы | [7] Архитектура, [8] Структура ПО |

---

## Правила качества (обязательны для всех разделов)

### Что ДЕЛАТЬ

- Пиши **фактами** из `.source/` — каждый термин/правило должен иметь источник
- Используй **термины домена**, не общетехнические (API, REST, Docker)
- Держи уровень **problem space**: *что нужно*, а не *как реализуем*
- Связывай сущности/правила/UC с терминами из глоссария

### Что НЕ ДЕЛАТЬ (антипаттерны)

| Антипаттерн | Пример | Почему плохо |
|-------------|--------|--------------|
| Общие формулировки | "управляет системой", "работает с данными" | Нет конкретики, бесполезно |
| Термины без контекста | "Заявка — документ" | Не отличить от других сущностей |
| UC без шагов | "Пользователь создает заявку" | Непонятно КАК |
| Придуманные термины | Термин не из `.source/` | Галлюцинация, нарушает верификацию |
| Технические детали | "REST API endpoint для..." | Это solution space, не problem space |

### Верификация

**Перед записью термина/правила/UC проверь:**
- [ ] Можно ли проследить до источника в `.source/`?
- [ ] Использованы ли термины из глоссария (или добавлены новые)?
- [ ] Нет ли технических деталей реализации?

**Если данных недостаточно:**
- Создай GAP в `docs/requirements/gap-tracking.md`
- Пометь placeholder: `<!-- @update-after:[N] -->`
- НЕ придумывай данные

---

## 1. Опиши название и назначение (H7)

**Что сделать:**
1. Найди название в `.source/` (и расшифровку, если аббревиатура)
2. Сформулируй назначение в 1-2 предложения

**Критерии качества:**
- Название: точное из `.source/`, не придуманное
- Назначение: конкретная функция + ценность (не "управление" или "обработка")

**Формат в H8:**
```markdown
## 1. Расшифровка названия / аббревиатуры
**<PROJECT_NAME / ABBR>** = <expansion>

**Суть (1-2 предложения):** <что делает + какую ценность дает>
```

---

## 2. Зафиксируй контекст, цель и границы (H7)

**Что сделать:**
1. Опиши контекст: что изменилось / почему появилась задача
2. Опиши боль: какие последствия текущего состояния
3. Сформулируй цель: что улучшить/автоматизировать
4. Зафиксируй границы: что **в цели**, что **вне цели**

**Критерии качества:**
- Контекст: конкретная тенденция/изменение (не "рынок растет")
- Боль: конкретные последствия (не "неэффективно")
- Цель: измеримое улучшение (не "сделать лучше")
- Out of Scope: минимум 1-2 пункта

**Формат в H8:**
```markdown
## 2. Обзор предметной области

### 2.1 Контекст проблемы
**Наблюдение/тенденция:** <что изменилось>
**Боль/проблема:** <что не работает и к чему приводит>
**Почему сейчас:** <почему важно решать сейчас>

### 2.2 Цель системы
Система предназначена для:
- <goal 1>
- <goal 2>

**Вне цели (Out of Scope):**
- <non-goal 1>
- <non-goal 2>

### 2.3 Критерии успеха
- **SC-01:** <проверяемый бизнес-результат>

### 2.4 Текущие процессы (as-is) [опционально]

> **Когда использовать:** при автоматизации/модернизации существующих процессов компании (brownfield проект)
> **Когда пропустить:** при разработке новой системы с нуля (greenfield проект)

**Описание текущих процессов:**
| Процесс | Описание текущего состояния | Проблемы | Затраты/метрики |
|---------|------------------------------|----------|-----------------|
| <название процесса> | Шаги: 1) ... 2) ... 3) ... | - ручной ввод<br>- дублирование<br>- ошибки | 2 часа/день<br>10% ошибок |

**Gap Analysis (as-is → to-be):**
| Боль/проблема | Причина (текущий процесс) | Решение (целевая система) | Связь с UC |
|---------------|----------------------------|---------------------------|------------|
| <конкретная боль> | <что в as-is вызывает проблему> | <как to-be решает проблему> | UC-XX |

> **Важно:** Gap analysis связывает боли текущих процессов с Use Cases раздела 5.
> Детальное моделирование to-be процессов — этап [5] (Event Storming, карта процесса).
```

---

## 2а. Анализ текущих процессов (опционально) (H7)

**Когда выполнять:** если проект модернизирует/автоматизирует существующие бизнес-процессы (brownfield).

**Что сделать:**
1. Проверь `.source/` на наличие описаний текущих процессов (регламенты, интервью, as-is документация)
2. Если описаний НЕТ — пропусти этот раздел, переходи к разделу 3
3. Если описания ЕСТЬ — заполни раздел 2.4 в H8

**Критерии качества:**
- Описание процесса: конкретные шаги, не общие фразы
- Проблемы: конкретные, измеримые (не "неэффективно")
- Затраты: время, деньги, ошибки (конкретные метрики)
- Gap analysis: каждая боль связана с конкретным UC из раздела 5

**Критерии пропуска раздела 2.4:**
- В `.source/` нет описаний текущих процессов
- Проект greenfield (разработка с нуля)
- Система не заменяет/не улучшает существующие процессы

---

## 3. Определи участников домена (H7)

**Кого считать актором:** человек ИЛИ внешняя система/сервис (для SDK/CLI/API).

**Что сделать:**
1. Выдели роли из `.source/`, которые инициируют действия или получают результат
2. Для каждой роли: кто это, цель, боли/риски

**Критерии качества:**
- Минимум 1 актор
- Описание: роль + контекст (не просто "пользователь")
- Цели: конкретные, связаны с системой (не "работать эффективно")
- Боли: конкретные проблемы текущего процесса

**Формат в H8:**
```markdown
## 3. Участники домена (Actors / Stakeholders)

| Роль/Актор | Описание | Цели | Боли/риски |
|---|---|---|---|
| <Actor> | <кто + контекст> | <что хочет> | <что мешает> |
```

---

## 4. Составь доменную модель (H7)

### 4.1 Глоссарий

**Что сделать:**
1. Выпиши доменные термины из `.source/`
2. Для каждого: определение + пример + антипример

**Критерии качества:**
- Минимум 5 терминов
- Определение: 1-2 предложения, содержит ЧТО это + ключевые атрибуты + контекст
- Пример: конкретный случай с характеристиками
- Антипример: от чего отличается (разграничение)

**Формат в H8:**
```markdown
## 4. Доменная модель

### 4.1 Глоссарий
| Термин | Определение | Пример | Антипример |
|---|---|---|---|
| <Term> | <что это + атрибуты + контекст> | <конкретный случай> | Не <похожее понятие> |
```

### 4.2 Ключевые сущности

**Что сделать:**
1. Из UC и глоссария извлеки ключевые объекты домена
2. Дай описание + 2-3 атрибута + роль в сценариях

**Критерии качества:**
- Минимум 1-2 сущности (рекомендуемо)
- Описание в терминах домена (не технических)
- Связь с UC (где используется)

**Формат в H8:**
```markdown
### 4.2 Ключевые сущности
| Сущность | Описание | Ключевые атрибуты | Роль в сценариях |
|---|---|---|---|
| <Entity> | <что это в домене> | `<a1>`, `<a2>` | <в каких UC> |

> Детализация (state machine, инварианты) — этапы [4] и [6].
```

### 4.3 Базовые доменные правила

**Что сделать:**
1. Найди в `.source/` правила "в мире домена так принято"
2. Правило должно использовать термины из глоссария

**Критерии качества:**
- Минимум 1 правило (рекомендуемо)
- Формулировка однозначная и проверяемая
- Причина объясняет бизнес-ценность

**Формат в H8:**
```markdown
### 4.3 Базовые доменные правила
- **BR-01:** <правило в терминах домена>
  - **Причина:** <бизнес-ценность>

> Детализация (исключения, инварианты) — этап [4].
```

---

## 5. Опиши Use Cases (H7)

**Что сделать:**
1. Составь карту UC (список)
2. Детально опиши минимум 1 UC

**Критерии качества:**
- Минимум 1 UC
- Happy path: минимум 3 шага
- Каждый шаг: <кто> + <действие> + <с чем/над чем>
- Данные: указаны вход и выход
- Используются термины из глоссария

**Формат в H8:**
```markdown
## 5. Доменные процессы и сценарии (Use Cases)

### 5.1 Карта сценариев
- **UC-01:** <name> — <goal> — актёр: <actor>

### 5.2 Детальное описание
#### UC-<NN>: <Use case name>
- **Цель:** <goal>
- **Актор:** <actor>
- **Триггер:** <что запускает>
- **Предусловия:** <что должно быть истинно>
- **Основной поток:**
  1. <Actor> <действие> <объект>
  2. System <действие> <объект>
  3. <Actor> получает <результат>
- **Данные:** вход — <input>, выход — <output>
- **Постусловия:** <новое состояние>

> Детализация (события, команды) — этап [5].
```

---

## 6. Выяви риски и допущения (H7)

**Когда добавлять:** если есть неопределенности или зависимости от внешних факторов.

**Формат в H8:**
```markdown
## 6. Риски и допущения
- **A-01 (допущение):** <assumption>
- **R-01 (риск):** <risk> — <последствия>

## 7. Приложения
### 7.1 Диаграммы (если созданы)
### 7.2 Parking Lot (открытые вопросы)
```

> **Следующий этап:** После завершения этапа [1] следует **[1] завершение: README L0** (обязательно).
> Процедура: `.manifest/readmemanifest.md`
> **Содержание README L0:**
> - 1-2 предложения: что за проект (из раздела 1)
> - 3-7 bullets: ключевые возможности (из целей)
> - Ссылки на `docs/requirements/`

---

## Критерии готовности этапа [1]

### Минимальные (блокируют переход к [2])

- [ ] **Название и назначение:** 1-2 предложения, конкретная функция + ценность
- [ ] **Глоссарий:** >= 5 терминов, каждый с определением + пример + антипример
- [ ] **Участники:** >= 1 актор с целями и болями
- [ ] **Use Cases:** >= 1 UC с happy path >= 3 шагов
- [ ] **Критерии успеха:** >= 1 проверяемый бизнес-критерий
- [ ] **Верификация:** все термины прослеживаются до `.source/`
- [ ] **H8 создан:** `docs/requirements/предметная область.md`

### Рекомендуемые

- [ ] **Контекст проблемы:** наблюдение + боль + почему сейчас
- [ ] **Сущности:** >= 1-2 с атрибутами и ролью в UC
- [ ] **Доменные правила:** >= 1 BR с причиной
- [ ] **Out of Scope:** зафиксировано

### Gap Tracking

- [ ] `gap-tracking.md` ОБЯЗАТЕЛЬНО обновлен (пустая таблица = валидный результат превентивной проверки)
- [ ] Все пробелы зафиксированы с приоритетами (HIGH/MEDIUM/LOW)
- [ ] Placeholder'ы помечены `<!-- @update-after:[N] -->`
- [ ] НЕТ придуманных данных — только GAP

**После принятия этапа [1] ОБЯЗАТЕЛЬНО выполни этап [1] завершение: README L0**
- Процедура: `.manifest/readmemanifest.md`
- Даже если README неполный, его создание обязательно для предотвращения репозитория без README

---

## Примеры (H7)

**Считать верным:**
- Термины и роли согласованы с источниками из `.source/`.
- Границы системы описаны через scope in/out.

**Считать неверным:**
- Описание области не связано с фактами и источниками.
- Границы системы отсутствуют или противоречат сценарию.

---

## Структура итогового документа (H8)

```markdown
# Предметная область системы <PROJECT_NAME>

## 1. Расшифровка названия / аббревиатуры
## 2. Обзор предметной области
### 2.1 Контекст проблемы
### 2.2 Цель системы
### 2.3 Критерии успеха
### 2.4 Текущие процессы (as-is) [опционально]
## 3. Участники домена (Actors / Stakeholders)
## 4. Доменная модель
### 4.1 Глоссарий
### 4.2 Ключевые сущности
### 4.3 Базовые доменные правила
## 5. Доменные процессы и сценарии (Use Cases)
### 5.1 Карта сценариев
### 5.2 Детальные UC
## 6. Риски и допущения (опционально)
## 7. Приложения (опционально)
```
