# Трек разработки технической документации

> **Важно:** этот файл в `.requirements/**` — **методика** (read-only).
> Определяет последовательность создания документации по шаблонам.

---

## 0. Принцип работы

1. Шаблоны находятся в `.requirements/**` (read-only).
2. Агент/разработчик **копирует структуру** шаблона в `docs/**` и заполняет фактами проекта.
3. Каждый следующий этап опирается на результаты предыдущего.
4. Если предыдущий этап не завершен — фиксировать это в `## Открытые вопросы` и создавать `.tasks/<id>`.

---

## 1. Последовательность чтения файлов-шаблонов для агента

**Агент ДОЛЖЕН читать файлы в следующем порядке:**

| Этап | Файл шаблона | Действие |
|------|--------------|---------|
| **Подготовка** | `.requirements/трек разработки.md` | Прочитать этот файл целиком (вы его читаете) |
| **[1]** | `.requirements/предметная область.md` | Скопировать структуру в `docs/requirements/предметная область.md`, заполнить фактами |
| **[2]** | `.requirements/обоснование выбора.md` | Скопировать в `docs/requirements/обоснование выбора.md` |
| **[3а]** | `.requirements/требования/требования_гост19.md` | Выбрать подходящий (ГОСТ 19 или ГОСТ 34 или иной, который оговорен в **[1]** и **[2]**) |
| **[3б]** | `.requirements/требования/требования_гост34.md` | Скопировать выбранный в `docs/requirements/требования/` |
| **[4]** | `.requirements/домены/определение доменов.md` | Скопировать в `docs/requirements/домены/реестр.md` + создать карточки доменов |
| **[5.0]** | `.requirements/сценарии/правила.md` | Прочитать правила Event Storming |
| **[5.1]** | `.requirements/сценарии/карта процесса.md` | Скопировать в `docs/requirements/сценарии/<domain>/` для каждого домена |
| **[5.2]** | `.requirements/сценарии/каталог мероприятий.md` | Скопировать в `docs/requirements/сценарии/<domain>/` |
| **[5.3]** | `.requirements/сценарии/ограниченные контексты.md` | Скопировать в `docs/requirements/сценарии/<domain>/` |
| **[6.0]** | `.requirements/структура Данных/правила проектирования данных.md` | Прочитать правила проектирования |
| **[6]** | `.requirements/структура Данных/описание БД.md` | Скопировать в `docs/requirements/структура Данных/описание БД.md` |
| **[6 шаблоны]** | `.requirements/структура Данных/шаблоны карточек.md` | Использовать для создания карточек объектов данных |
| **[7 TL]** | `.requirements/архитектура/описание TL.md` | Скопировать в `docs/requirements/архитектура/TL.md` |
| **[7 AL]** | `.requirements/архитектура/описание AL.md` | Скопировать в `docs/requirements/архитектура/AL.md` |
| **[7 BL]** | `.requirements/архитектура/описание BL.md` | Скопировать в `docs/requirements/архитектура/BL.md` |
| **[7 связи]** | `.requirements/архитектура/описание связи TL AL BL.md` | Скопировать в `docs/requirements/архитектура/связи.md` |
| **[7 сущности]** | `.requirements/архитектура/сущности архитекутры.md` | Скопировать в `docs/requirements/архитектура/сущности.md` |
| **[8 стек]** | `.requirements/структура ПО/стек проекта.md` | Скопировать в `docs/requirements/структура ПО/стек проекта.md` |
| **[8 файловая]** | `.requirements/структура ПО/файловая структура проекта.md` | Скопировать в `docs/requirements/структура ПО/файловая структура.md` |
| **[8 зависимости]** | `.requirements/структура ПО/зависимости.md` | Скопировать в `docs/requirements/структура ПО/зависимости.md` |
| **[8 ports]** | `.requirements/структура ПО/ports.md` | Скопировать в `docs/requirements/структура ПО/ports.md` |
| **[9 тестирование]** | `.requirements/тестирование/стек тестов.md` | Скопировать в `docs/requirements/тестирование/стек тестов.md` |
| **[9 испытание]** | `.requirements/тестирование/испытание системы.md` | Скопировать в `docs/requirements/тестирование/испытание системы.md` |

---

## 2. Последовательность этапов

```
[1] Предметная область
         |
         v
[2] Обоснование выбора
         |
         v
[3] Требования
         |
         v
[4] Домены
         |
         v
[5] Сценарии
         |
         v
[6] Структура данных
         |
         v
[7] Архитектура
         |
         v
[8] Структура ПО
         |
         v
[9] Тестирование
```

---

## 3. Детализация этапов

### Этап 1: Предметная область

**Цель:** понять "что строим и зачем", зафиксировать термины и границы.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/предметная область.md` | `docs/requirements/предметная область.md` |

**Входы:** интервью, регламенты, законы, договоры, AS-IS описания.

**Выходы:**
- Глоссарий терминов
- Участники домена (actors)
- Доменные сущности и правила
- Use Cases (верхнеуровневые)
- Критерии успеха

**Блокирует:** все последующие этапы (это фундамент).

---

### Этап 2: Обоснование выбора

**Цель:** зафиксировать ключевые технические и методологические решения.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/обоснование выбора.md` | `docs/requirements/обоснование выбора.md` |

**Входы:** предметная область, ограничения (бюджет, сроки, команда), NFR.

**Выходы:**
- Выбор стека (языки, фреймворки, БД)
- Выбор методологии (Event Storming, DDD, etc.)
- Формат диаграмм (mermaid/plantuml)
- Обоснование каждого решения
- Альтернативы и причины отказа

**Блокирует:** структура данных, архитектура, структура ПО.

---

### Этап 3: Требования

**Цель:** формализовать функциональные и нефункциональные требования.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/требования/требования_гост19.md` | `docs/requirements/требования/требования_гост19.md` |
| `.requirements/требования/требования_гост34.md` | `docs/requirements/требования/требования_гост34.md` |

**Входы:** предметная область, обоснование выбора, договор/ТЗ заказчика.

**Выбор шаблона:**
- **ГОСТ 19** — для программных продуктов (библиотеки, CLI, сервисы)
- **ГОСТ 34** — для автоматизированных систем (комплексные решения с оборудованием, инфраструктурой)
- **Иной стандарт** — если проект требует другого стандарта (ISO, IEEE, внутренний регламент):
  1. Зафиксировать выбор стандарта в `docs/requirements/обоснование выбора.md`
  2. Создать шаблон `.requirements/требования/<standard>.md` по аналогии с ГОСТ 19/34
  3. Или адаптировать ближайший существующий шаблон под требуемый стандарт
  4. Результат сохранять в `docs/requirements/требования/<standard>.md` 

**Выходы:**
- Функциональные требования (FR-*)
- Нефункциональные требования (NFR-*)
- Требования к данным
- Требования к интерфейсам
- Требования к документации

**Блокирует:** сценарии, архитектура, тестирование.

---

### Этап 4: Домены

**Цель:** разбить систему на ограниченные контексты (bounded contexts).

| Шаблон | Результат |
|--------|-----------|
| `.requirements/домены/определение доменов.md` | `docs/requirements/домены/реестр.md` + `docs/requirements/домены/<slug>.md` |

**Входы:** предметная область, требования.

**Выходы:**
- Реестр доменов с описанием
- Карточка каждого домена
- Границы ответственности
- Зависимости между доменами

**Блокирует:** сценарии (создаются по доменам).

---

### Этап 5: Сценарии (Event Storming)

**Цель:** описать процессы, события и контексты для каждого домена.

| Шаблон | Результат (для каждого домена) |
|--------|--------------------------------|
| `.requirements/сценарии/карта процесса.md` | `docs/requirements/сценарии/<domain>/карта процесса.md` |
| `.requirements/сценарии/каталог мероприятий.md` | `docs/requirements/сценарии/<domain>/каталог мероприятий.md` |
| `.requirements/сценарии/ограниченные контексты.md` | `docs/requirements/сценарии/<domain>/ограниченные контексты.md` |

**Методика:** `.requirements/сценарии/правила.md`

**Входы:** домены, требования.

**Выходы (для каждого домена):**
- Карта процесса (потоки, этапы, последовательности)
- Каталог мероприятий (события, payload)
- Ограниченные контексты (границы внутри домена)
- Связь с требованиями

**Блокирует:** структура данных (агрегаты -> сущности).

---

### Этап 6: Структура данных

**Цель:** описать модель данных и схему хранения.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/структура Данных/описание БД.md` | `docs/requirements/структура Данных/описание БД.md` |

**Методики:**
- `.requirements/структура Данных/правила проектирования данных.md`
- `.requirements/структура Данных/шаблоны карточек.md`

**Входы:** обоснование выбора (тип БД), сценарии (агрегаты, события).

**Выходы:**
- Карта хранилищ
- Перечень объектов данных
- Карточки объектов (`tables/*.md`, `collections/*.md`, etc.)
- Диаграммы (ERD/Class/Component)
- Индексы, ограничения, retention

**Логика:** сценарии дают агрегаты -> агрегаты превращаются в сущности хранения.

**Блокирует:** архитектура (repositories, data access layer).

---

### Этап 7: Архитектура

**Цель:** описать архитектурные слои и их взаимодействие.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/архитектура/описание TL.md` | `docs/requirements/архитектура/TL.md` |
| `.requirements/архитектура/описание AL.md` | `docs/requirements/архитектура/AL.md` |
| `.requirements/архитектура/описание BL.md` | `docs/requirements/архитектура/BL.md` |
| `.requirements/архитектура/описание связи TL AL BL.md` | `docs/requirements/архитектура/связи.md` |
| `.requirements/архитектура/сущности архитекутры.md` | `docs/requirements/архитектура/сущности.md` |

**Входы:** обоснование выбора, сценарии, структура данных.

**Выходы:**
- Technology Layer (инфраструктура, узлы, системное ПО)
- Application Layer (use cases, orchestration)
- Business Layer (domain logic, entities)
- Связи между слоями
- Архитектурные сущности

**Логика:** архитектура проектируется вокруг модели данных (repositories, use cases).

**Блокирует:** структура ПО.

---

### Этап 8: Структура ПО

**Цель:** описать техническую организацию проекта.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/структура ПО/стек проекта.md` | `docs/requirements/структура ПО/стек проекта.md` |
| `.requirements/структура ПО/файловая структура проекта.md` | `docs/requirements/структура ПО/файловая структура.md` |
| `.requirements/структура ПО/зависимости.md` | `docs/requirements/структура ПО/зависимости.md` |
| `.requirements/структура ПО/ports.md` | `docs/requirements/структура ПО/ports.md` |

**Входы:** обоснование выбора, архитектура.

**Выходы:**
- Технологический стек с версиями
- Файловая структура репозитория
- Зависимости (internal/external)
- Порты и интерфейсы

**Логика:** организация файлов/модулей под архитектуру.

**Блокирует:** реализацию.

---

### Этап 9: Тестирование

**Цель:** описать стратегию и план тестирования.

| Шаблон | Результат |
|--------|-----------|
| `.requirements/тестирование/стек тестов.md` | `docs/requirements/тестирование/стек тестов.md` |
| `.requirements/тестирование/испытание системы.md` | `docs/requirements/тестирование/испытание системы.md` |

**Входы:** требования, сценарии, архитектура.

**Выходы:**
- Стек тестирования (unit/integration/e2e)
- План испытаний
- Критерии приемки
- Матрица покрытия требований

**Блокирует:** релиз.

---

## 4. Зависимости между этапами

```
[1] Предметная область
         |
         v
[2] Обоснование выбора
         |
         v
[3] Требования
         |
         v
[4] Домены
         |
         v
[5] Сценарии
         |
         v
    [5.1] Реестр сценариев
         |
         v
    [5.2] Карта процесса
         |
         v
    [5.3] Каталог мероприятий
         |
         v
    [5.4] Ограниченные контексты
         |
         v
[6] Структура данных
         |
         v
[7] Архитектура
         |
         v
[8] Структура ПО
         |
         v
[9] Тестирование
```

---

## 5. Чеклист готовности этапа

Перед переходом к следующему этапу проверить:

* [ ] Шаблон скопирован в `docs/**`
* [ ] Все обязательные секции заполнены
* [ ] Ссылки на предыдущие этапы актуальны
* [ ] Открытые вопросы зафиксированы
* [ ] Задачи на доработку созданы в `.tasks/`

---

## 6. Правила для агентов

1. **Начинать с этапа 1** — не пропускать этапы.
2. **Проверять входы** — если предыдущий этап не завершен, зафиксировать это.
3. **Не галлюцинировать** — если данных нет, писать "Не определено источниками".
4. **Создавать задачи** — любой пробел = `.tasks/<id>`.
5. **Не редактировать `.requirements/**`** — только читать и копировать структуру.
