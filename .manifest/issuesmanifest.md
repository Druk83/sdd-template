# Issues Manifest

Краткий регламент по созданию, триажу и использованию Issues в репозитории.  
Документ предназначен для людей и агентов (LLM-инструментов), которые помогают оформлять документацию и задачи.

> **Зоны записи (write) / чтения (read):**
> - `.requirements/**` — **методики/шаблоны** (read-only).
> - `docs/**` — **проектные документы и результаты анализа** (write).
> - `.tasks/**` — **задачи (рабочие артефакты управления работой)** (write).
> - Issues в трекере (например, GitHub Issues) — **первичный реестр Issues** (write).

---

## 1. Цель
- Фиксировать проблемы, баги, инциденты, риски, вопросы и задачи исследования.
- Обеспечить трассировку: **Issue → Triage → Task(s) → PR/Release → Closing note**.
- Снизить “шум”: каждый Issue должен быть либо **в работе**, либо **ожидает данных**, либо **закрыт с причиной**.

---

## 2. Когда создавать Issue

Создаём Issue, если выполняется хотя бы одно:
- Требуется сбор информации / воспроизведение / RCA (root cause analysis).
- Есть влияние на пользователей/production (incident) или на безопасность (security).
- Нужна координация между подсистемами/командами.
- Нужна оценка/приоритезация перед постановкой конкретной задачи.
- Нужно задокументировать решение/компромисс (RFC-lite через Issue).

Не создаём Issue, если:
- Это маленькое изменение с ясным решением и без рисков → сразу Task/PR.
- Это личная заметка без ценности для команды → не в репозиторий.

---

## 3. Типы Issues (обязательный выбор)
Используются labels формата `type:*`:
- `type:bug`
- `type:incident`
- `type:security`
- `type:infra`
- `type:doc`
- `type:question`
- `type:research` (спайк/исследование)

---

## 4. Приоритет и тяжесть (раздельно)

### 4.1 Priority (когда делать)
Используются labels формата `priority:*`:
- `priority:P0` — критично, блокирует прод/релиз, немедленная реакция
- `priority:P1` — высокий, существенное влияние, ближайший спринт/релиз
- `priority:P2` — средний, планово
- `priority:P3` — низкий, когда будет время

### 4.2 Severity (насколько больно)
Используются labels формата `severity:*`:
- `severity:S0` — останов сервиса / потеря данных / компрометация
- `severity:S1` — значимая деградация / крупный функционал сломан
- `severity:S2` — частичная деградация / обходной путь есть
- `severity:S3` — косметика / неудобство

Примечание: если Severity пока не ясна — допускается временно указать только Priority, Severity уточняется на triage.

---

## 5. Статусы (labels жизненного цикла)
Используются labels формата `status:*`:
- `status:needs-info` — не хватает данных (ждём автора)
- `status:triaged` — разобрано, есть решение/план
- `status:ready` — готово к реализации (можно брать в работу)
- `status:in-progress` — есть исполнитель/ветка/PR
- `status:blocked` — есть блокер (указать)
- `status:done` — закрыто (указать причину закрытия)

---

## 6. Минимальные поля Issue (Definition of Ready)
Issue считается валидным, если заполнено:
- Заголовок: “Что + где + эффект” (кратко).
- `type:*` (обязателен).
- `priority:P*` (обязателен).
- Описание/контекст: что произошло и где.
- Для `type:bug` и `type:incident`: Expected vs Actual (обязателен).
- Для `type:bug`: шаги воспроизведения **или** чёткий симптом + логи.
- Окружение (если применимо): версия, OS, сервис, конфиг, коммит/релиз.
- Связи (если есть): ссылки на PR/Task/лог/метрику/алёрт.

---

## 7. Политика безопасности данных

Запрещено прикладывать в Issue:
- секреты (tokens/keys/passwords), приватные ключи;
- персональные данные/PII без маскирования;
- закрытые ссылки/дампы без доступа команды.

Для `type:security`:
- по умолчанию использовать принятую в проекте приватную процедуру (если определена);
- в публичном Issue — только минимальные сведения без деталей эксплуатации/PoC.

---

## 8. Workflow (Triage → Task → PR → Close)

1) **Создание**: автор выставляет `type:*`, `priority:*`, добавляет описание и базовые данные.

2) **Triage** (triage-owner):
- подтверждает/исправляет `type`, `priority`, `severity`;
- ставит `status:triaged` или `status:needs-info`;
- фиксирует решение: делаем / не делаем / откладываем / нужно исследование.

3) **Реализация**:
- если нужна декомпозиция/план — создаётся Task: `\.tasks/<TASK-ID>.md`;
- ссылка на Task добавляется в Issue;
- Issue получает `status:in-progress`.

4) **PR**:
- PR должен ссылаться на Issue (например: `Fixes #123` / `Closes #123`).

5) **Закрытие**:
- Issue закрывается при merge/release, либо с явной причиной:
  - `won't-fix`, `duplicate`, `cannot-reproduce`, `out-of-scope`;
- в конце оставляется “Closing note”: что сделано, в какой версии, как проверить.

---

## 9. Правила для агентов/инструментов
- Агент не создаёт Issue автоматически, если нет:
  - понятного симптома + контекста, или
  - шагов воспроизведения/логов, или
  - явной команды пользователя “создай Issue”.
- Агент может подготовить текст Issue и чеклист, но не выполняет `git commit`/`push`.
- При создании Task по Issue агент обязан:
  - указать ссылку на Issue в `\.tasks/<TASK-ID>.md`;
  - добавить ссылку на Task в Issue.
- Агент обязан соблюдать политику безопасности: маскировать секреты/PII.

---

## 10. Шаблоны (копипаст)

### 10.1 BUG

# <Коротко: что + где + эффект>

**Type:** `type:bug`  
**Priority:** `priority:P2`  
**Severity:** `severity:S2`  
**Status:** `status:needs-info` | `status:triaged`

## Контекст
- Компонент/сервис: <...>
- Версия/коммит: <...>
- Окружение: <OS/DB/runtime/etc>
- Частота: <always/sometimes>
- Impact: <кто/что страдает>

## Шаги воспроизведения
1. ...
2. ...

## Ожидаемое поведение
...

## Фактическое поведение
...

## Логи/скриншоты
<вставить/ссылка>

## Дополнительно
- Workaround: <есть/нет>
- Связанные задачи (если создано): `.tasks/<TASK-ID>.md`
- Связанные PR: <link>

---

### 10.2 INCIDENT

#### Инцидент: <симптом + сервис>

**Type:** `type:incident`  
**Priority:** `priority:P0`  
**Severity:** `severity:S0`  
**Status:** `status:in-progress`

**Таймлайн**
- **Start:** <time>
- **Detect:** <time>
- **Mitigate:** <time>
- **Resolve:** <time>

**Impact**
- <пользователи/проценты/данные>

**Метрики/алёрты**
- <links>

**Причина (RCA)**
- <первичное/финальное>

**Действия**
- [ ] Mitigation
- [ ] Fix
- [ ] Prevention

**Связи**
- **Tasks:** `.tasks/<TASK-ID>.md`
- **PR:** <link>
- **Release:** <version>

---

### 10.3 SECURITY (безопасный минимум)

#### Security: кратко без деталей эксплуатации

**Type:** `type:security`  
**Priority:** `priority:P0`  
**Severity:** `severity:S0`  
**Status:** `status:triaged`

**Описание (без секретов/PoC)**
- ...

**Затронутые компоненты**
- ...

**План**
- [ ] Оценка
- [ ] Исправление
- [ ] Проверка/регрессия

---

### 10.4 QUESTION / RESEARCH

#### Вопрос / Исследование: тема

**Type:** `type:question` | `type:research`  
**Priority:** `priority:P2`  
**Status:** `status:triaged` | `status:needs-info`

**Контекст**
- ...

**Вопрос(ы)**
- Q1: ...
- Q2: ...

**Гипотезы / варианты**
- Option A: ...
- Option B: ...

**Решение / итог**
(заполняется после обсуждения)

---

## 11. Автопроверки и рекомендации

**Рекомендуемые правила для CI/линтера документации:**
- `type:bug` без **Expected / Actual** → **warning**
- `type:bug` без **Repro** или **Logs** → **warning**
- Issue без `type:*` или `priority:*` → **warning**
- Task без ссылки на Issue (если Task создан по Issue) → **warning**

Рекомендуется регулярный обзор старых Issues (`stale`) и пересмотр приоритетов.

---

## 12. Примеры качества

**Хороший Issue:**
- содержит репродукцию или логи
- есть **Expected / Actual**
- указан **impact** и **priority**
- есть связи на Task / PR / метрики

**Плохой Issue:**
- «сломалось, помогите» без контекста → переводится в `status:needs-info` с запросом дополнительных данных.
